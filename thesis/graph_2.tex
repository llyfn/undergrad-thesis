\begin{tikzpicture}[node distance=0.7cm]

    % --- Input Data ---
    \node (input) [block] {Input Text \\ \scriptsize(\texttt{context [SEP] response})};

    % --- RoBERTa Encoder ---
    \node (encoder) [block, right=of input] {RoBERTa Encoder \\ \scriptsize\textit{(Weights from Stage 1)}};
    \draw [main_arrow] (input) -- (encoder);

    % --- Classifier Head ---
    \node (classifier) [block, right=1.0cm of encoder] {Classifier Head \\ \scriptsize(Linear Layer + Softmax)};
    \draw [main_arrow] (encoder) -- (classifier) node [midway, above, font=\scriptsize] {\texttt{[CLS]}};

    % --- Final Prediction ---
    \node (prediction) [output, right=of classifier] {Pred};
    \draw [main_arrow] (classifier) -- (prediction);

    % --- Loss Calculation ---
    \node (loss) [block, right=of prediction] {Cross-Entropy Loss};
    \draw [main_arrow] (prediction) -- (loss);

    % --- True Label Input ---
    \node (label_text) [above=0.5cm of loss] {True Label};
    \draw [main_arrow] (label_text) -- (loss);

    % --- Weight Update Paths ---
    \draw [update_arrow] (loss.south) -- ++(0,-0.5) -| (classifier.south)
    node [pos=0.25, above, font=\scriptsize] {Update};

    \draw [update_arrow] (loss.south) -- ++(0,-0.75) -| (encoder.south)
    node [pos=0.25, below, font=\scriptsize] {Fine-tune};

\end{tikzpicture}